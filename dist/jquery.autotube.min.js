/*! jquery.autotube - v1.0.0 - 2016-08-29
* https://github.com/CarlRaymond/jquery.autotube
* Copyright (c) 2016 ; Licensed GPLv2 */
!function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b="https://www.googleapis.com/youtube/v3/videos",c=/^https?:\/\/(www\.)?youtube.com\/watch\?v=([^?&]+)/i,d=/^https?:\/\/(www\.)?youtube.com\/v\/([^\/\?]+)/i,e=/^https?:\/\/youtu.be\/([^\/]+)/i,f=/^https?:\/\/(www\.)?youtube.com\/embed\/([^\/]+)/i;a.expr[":"].youtube=function(b){var g=b.href;if(!g)return!1;var h="videoId",i=g.match(c);return null!=i?(a(b).data(h,i[2]),!0):(i=g.match(d),null!=i?(a(b).data(h,i[2]),!0):(i=g.match(e),null!=i?(a(b).data(h,i[1]),!0):(i=g.match(f),null!=i?(a(b).data(h,i[2]),!0):!1)))};var g=new TemplateEngine,h=a.Deferred(),i=!1;window.onYouTubeIframeAPIReady=function(){h.resolve()};var j=function(){i||(i=!0,a.getScript("https://www.youtube.com/iframe_api"))},k=function(a,b,c){b.parent().append(c)},l=function(b){a("body").append(b)},m=function(a){var b=a.href.match(c);return null!=b?b[2]:(b=a.href.match(d),null!=b?b[2]:(b=a.href.match(e),null!=b?b[1]:(b=a.href.match(f),null!=b?b[2]:void 0)))},n=function(c,d){var e=this,f=[];e.each(function(b){var c=a(this).data("videoId");c||(c=m(this),a(this).data("videoId",c)),f.push(c)});var g={part:"snippet,contentDetails"},h=a.extend({},g,c),i={id:f.join(","),part:h.part,key:h.apikey},j=a.get(b,i);return j.done(function(b){e.each(function(c){var e=b.items[c],f=new Iso8601(e.contentDetails.duration);e.autotube={duration:f.toDisplay()},a(this).data("youtube",e),d&&d.call(this,e)})}),j},o={calloutTemplate:"video-callout-template",playerTemplate:"video-player-template",calloutImageFilename:"default.jpg",calloutCallback:k,playerCallback:l,width:640,height:360},p=function(b){var c=a.extend({},o,b);0!==this.filter(function(){return a(this).data("autotube")}).length&&a.error("Autotube already applied to a selected element");var d;d=c.calloutRenderer?a.Deferred().resolve(c.calloutRenderer):g.renderer(c.calloutTemplate);var e=this;return d.done(function(b){e.each(function(d){var e=a(this),f=m(this),g=e.data("title")||e.text(),h={settings:c,videoId:f,posterId:"video-poster-"+d,playerId:"video-player-"+d,iframeId:"video-iframe-"+d,posterUrl:"https://img.youtube.com/vi/"+f+"/"+c.calloutImageFilename,title:g},i=b(h),j=a(i);e.attr("href","#");var k=a("a[href='#']",j).add(e);k.on("click.autotube",null,h,q),e.data("autotube",h),c.calloutCallback(h,e,j)})}),c},q=function(b){var c=b.data,d=c.settings;j();var e;e=c.playerRenderer?a.Deferred().resolve(c.settings.playerRenderer):g.renderer(c.settings.playerTemplate),a.when(e,h).then(function(b){var e=b(c),f=a(e),g=f.find("#"+c.iframeId)[0],h=new YT.Player(g,{height:d.height,width:d.width,videoId:c.videoId});c.settings.playerCallback(c,f,h)})};a.fn.autotube=function(a){if(r[a])return r[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!=typeof a&&a)throw"Method "+a+" does not exist on jQuery.autotube";return r.init.apply(this,arguments)};var r={init:p};a.fn.getMetadata=n,a.autotube={videoId:m}});