/*! jquery.autotube - v1.0.0 - 2016-09-10
* https://github.com/CarlRaymond/jquery.autotube
* Copyright (c) 2016 ; Licensed GPLv2 */
!function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b={part:"snippet,contentDetails",datakey:"autotube"},c="https://www.googleapis.com/youtube/v3/videos",d="videoId",e=/^https?:\/\/(www\.)?youtube.com\/watch\?v=([^?&]+)/i,f=/^https?:\/\/(www\.)?youtube.com\/v\/([^\/\?]+)/i,g=/^https?:\/\/youtu.be\/([^\/]+)/i,h=/^https?:\/\/(www\.)?youtube.com\/embed\/([^\/]+)/i;a.expr[":"].youtube=function(b){var c=b.href;if(!c)return!1;var i=c.match(e);return null!=i?(a(b).data(d,i[2]),!0):(i=c.match(f),null!=i?(a(b).data(d,i[2]),!0):(i=c.match(g),null!=i?(a(b).data(d,i[1]),!0):(i=c.match(h),null!=i?(a(b).data(d,i[2]),!0):!1)))};var i=new TemplateEngine,j=new YoutubeApiLoader,k=function(b){var c=a(b).data(d);if(null==c){var i=b.href.match(e);null!=i?c=i[2]:(i=b.href.match(f),null!=i?c=i[2]:(i=b.href.match(g),null!=i?c=i[1]:(i=b.href.match(h),null!=i&&(c=i[2]))))}return null!=c&&a(b).data(d,c),c},l=function(b,d){var e=[];b.each(function(a){e.push(k(this))});var f={id:e.join(","),part:d.part,key:d.apikey};return def=a.get(c,f),def.done(function(c){b.each(function(b){var e=c.items[b],f=new Iso8601(e.contentDetails.duration),g={_settings:d,_playingTime:f.toDisplay()};a.extend(e,g),a(this).data(d.datakey,e)})}),def},m=function(c,d){var e=this,f=a.extend({},b,c);return l(e,f).done(function(){d&&e.each(function(){var b=a(this).data(f.datakey);d.call(this,b)})}),e},n=function(c,d){var e,f=this,g=a.extend({},b,c);e="function"==typeof g.template?a.Deferred().resolve(g.template):i.template(g.template);var h=l(f,g);a.when(e,h).done(function(b,c){f.each(function(){var c=a(this).data(g.datakey),e="autotube-poster-"+k(this);c._posterId=e;var f=a(b(c));if(g.placer){if(!o[g.placer])throw'Placer "'+g.placer+'" is not valid.';o[g.placer].call(this,f,c)}if(g.onclick){var h=null;if("string"==typeof g.onclick){if(h=q[g.onclick],null==h)throw'Click handler "'+g.onclick+'" is not valid.'}else h=g.onclick;var i=h.bind(f[0]);a(document).on("click","#"+e,c,i)}d&&d.call(this,f,c)})})},o={appendToParent:function(b){a(this).parent().append(b)},appendToLink:function(b){a(this).append(b)},replaceLink:function(b){a(this).replaceWith(b)}},p=function(b){var c=this,d=j.load();return d.done(function(d){var e={videoId:b.data.id,height:360,width:640},f=a(c).find(b.data._settings.posterSelector)[0];new d.Player(f,e)}),!1},q={replacePoster:p};a.fn.videoMetadata=m,a.fn.videoPoster=n,a.autotube={videoId:k}});