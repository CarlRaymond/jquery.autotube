/*! jquery.autotube - v1.0.0 - 2016-08-29
* https://github.com/CarlRaymond/jquery.autotube
* Copyright (c) 2016 ; Licensed GPLv2 */
!function(a){"use strict";"object"==typeof module&&"object"==typeof module.exports?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){var b="https://www.googleapis.com/youtube/v3/videos",c=/^https?:\/\/(www\.)?youtube.com\/watch\?v=([^?&]+)/i,d=/^https?:\/\/(www\.)?youtube.com\/v\/([^\/\?]+)/i,e=/^https?:\/\/youtu.be\/([^\/]+)/i,f=/^https?:\/\/(www\.)?youtube.com\/embed\/([^\/]+)/i;a.expr[":"].youtube=function(b){var g=b.href;if(!g)return!1;var h="videoId",i=g.match(c);return null!=i?(a(b).data(h,i[2]),!0):(i=g.match(d),null!=i?(a(b).data(h,i[2]),!0):(i=g.match(e),null!=i?(a(b).data(h,i[1]),!0):(i=g.match(f),null!=i?(a(b).data(h,i[2]),!0):!1)))};var g=a.Deferred(),h=!1;window.onYouTubeIframeAPIReady=function(){g.resolve()};var i=function(){h||(h=!0,a.getScript("https://www.youtube.com/iframe_api"))},j=function(a,b,c){b.parent().append(c)},k=function(b){a("body").append(b)},l=function(a){var b=a.href.match(c);return null!=b?b[2]:(b=a.href.match(d),null!=b?b[2]:(b=a.href.match(e),null!=b?b[1]:(b=a.href.match(f),null!=b?b[2]:void 0)))},m=/^[A-Za-z][A-Za-z0-9.:_-]*$/,n=/^\/.*/,o={},p=function(a){return new Function("obj","var p=[], print=function() { p.push.apply(p, arguments); };with(obj) { p.push('"+a.replace(/[\r\t\n]/g," ").split("{{").join("	").replace(/((^|}})[^\t]*)'/g,"$1\r").replace(/\t=(.*?)}}/g,"',$1,'").split("	").join("');").split("}}").join("p.push('").split("\r").join("\\'")+"');} return p.join('');")},q=function(b){var c,d=a.Deferred();if(o[b])return d.resolve(o[b]),d;if(m.test(b)){var e=a("#"+b);if(0===e.length)throw'Template not found: "'+b+'". Use the "calloutTemplate" option with the id of a script block (of type "text/html") or a url to an external HTML file containing the template.';return c=p(e.html()),o[b]=c,d.resolve(c),d}if(n.test(b)){var f=a.ajax(b,{dataType:"html"}),g=f.then(function(a){return c=p(a),o[b]=c,c});return f.fail(function(a,c,d){window.console&&console.log('Error fetching template "'+b+'": '+d)}),g}return c=p(b),d.resolve(c)},r=function(c){var d=this,e=[];d.each(function(b){var c=a(this).data("videoId");c||(c=l(this),a(this).data("videoId",c)),e.push(c)});var f={id:e.join(","),key:ytDataApiKey,part:"snippet,contentDetails"},g=a.get(b,f);return g.done(function(b){d.each(function(d){var e=b.items[d],f=new Iso8601(e.contentDetails.duration);e.autotube={duration:f.toDisplay()},a(this).data("youtube",e),c&&c.call(this,e)})}),g},s={calloutTemplate:"video-callout-template",playerTemplate:"video-player-template",calloutImageFilename:"default.jpg",calloutCallback:j,playerCallback:k,width:640,height:360},t=function(b){var c=a.extend({},s,b);0!==this.filter(function(){return a(this).data("autotube")}).length&&a.error("Autotube already applied to a selected element");var d;d=c.calloutRenderer?a.Deferred().resolve(c.calloutRenderer):q(c.calloutTemplate);var e=this;return d.done(function(b){e.each(function(d){var e=a(this),f=l(this),g=e.data("title")||e.text(),h={settings:c,videoId:f,posterId:"video-poster-"+d,playerId:"video-player-"+d,iframeId:"video-iframe-"+d,posterUrl:"https://img.youtube.com/vi/"+f+"/"+c.calloutImageFilename,title:g},i=b(h),j=a(i);e.attr("href","#");var k=a("a[href='#']",j).add(e);k.on("click.autotube",null,h,u),e.data("autotube",h),c.calloutCallback(h,e,j)})}),c},u=function(b){var c=b.data,d=c.settings;i();var e;e=c.playerRenderer?a.Deferred().resolve(c.settings.playerRenderer):q(c.settings.playerTemplate),a.when(e,g).then(function(b){var e=b(c),f=a(e),g=f.find("#"+c.iframeId)[0],h=new YT.Player(g,{height:d.height,width:d.width,videoId:c.videoId});c.settings.playerCallback(c,f,h)})};a.fn.autotube=function(a){if(v[a])return v[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!=typeof a&&a)throw"Method "+a+" does not exist on jQuery.autotube";return v.init.apply(this,arguments)};var v={init:t};a.fn.getMetadata=r,a.autotube={videoId:l,templateRenderer:q}});